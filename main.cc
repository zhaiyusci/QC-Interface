#include"qcinterface.h"
#include<iostream>
#include<iomanip>

int main()
{
  Molecule fc;
  std::cout.setf(std::ios::fixed, std::ios::floatfield);
  std::cout << std::setprecision(8);
  std::cout <<"Molecule build" <<std::endl;
  std::string xyz;
  std::cout <<"string build" <<std::endl;

  std::vector<double> nm {0.797454089694, -0.020938119376, -0.000144494685, -0.566311738706, -0.000971091009, -0.000038629363, -0.080948801080, 0.039382756412, 0.001184955042, 0.014472454756, 0.134974187268, -0.002281178210, 0.002425100017, -0.002982822031, -0.001678572167, 0.003547524682, -0.014409116292, 0.013305781135, -0.021056649112, -0.017454684106, -0.000769968282, 0.006757786148, -0.013595706319, -0.006218118671, -0.068655882920, -0.017407973975, 0.001040597616, 0.007116434431, -0.033577955469, 0.026548308856, 0.021798800329, 0.024076612966, -0.012300760673, 0.001197355265, -0.080286837326, -0.019846359596};
  XYZ norm;
  norm.set(nm);
  fc.addatom("C", -0.49125725,  0.15475465,  0.00259742);
  fc.addatom("O", -0.35636650,  1.36073522,  0.03696966);
  fc.addatom("N",  0.61412562, -0.67342850, -0.01616011);
  fc.addatom("H",  0.54854144, -1.66954225, -0.06086657);
  fc.addatom("C",  1.95132905, -0.07683611, -0.00771441);
  fc.addatom("H",  2.03626340,  0.67283577,  0.80319670);
  fc.addatom("H",  2.71982809, -0.84912838,  0.14346644);
  fc.addatom("H",  2.15295012,  0.45115010, -0.95847999);
  fc.addatom("C", -1.83197786, -0.52789234,  0.00057012);
  fc.addatom("H", -2.14548314, -0.76658721,  1.02749395);
  fc.addatom("H", -2.59336417,  0.15355683, -0.41481735);
  fc.addatom("H", -1.86003777, -1.44978640, -0.58847590);



  for(double Q=-1.0; Q<=1.0; Q+=0.01){
    fc.reset();
    fc.move(norm,Q);
    fc.mopac(PM7);
    std::cout << Q << "     " << fc.energy << std::endl;
  }

  return 0;
}
